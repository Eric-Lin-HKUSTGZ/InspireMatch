# InspireMatch

åäººç»å†å‘é‡æ•°æ®åº“æ„å»ºä¸æ£€ç´¢ç³»ç»Ÿ

## é¡¹ç›®ç®€ä»‹

InspireMatch æ˜¯ä¸€ä¸ªåŸºäº RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æŠ€æœ¯çš„åäººç»å†çŸ¥è¯†åº“ç³»ç»Ÿã€‚ç³»ç»Ÿé€šè¿‡æœç´¢ã€æå–ã€ç»“æ„åŒ–å­˜å‚¨åäººçš„ç»å†æ•…äº‹ï¼Œæ„å»ºå‘é‡æ•°æ®åº“ï¼Œæ”¯æŒé«˜æ•ˆçš„è¯­ä¹‰æ£€ç´¢å’Œå…³é”®è¯æ£€ç´¢ï¼Œä¸ºç”¨æˆ·æä¾›çµæ„Ÿä¸æŒ‡å¯¼ã€‚

## æ ¸å¿ƒåŠŸèƒ½

- ğŸ” **æ™ºèƒ½æœç´¢**: ä½¿ç”¨ sonar-pro-search æœç´¢9ä¸ªèŒä¸šé¢†åŸŸçš„åäººç»å†
- ğŸ“Š **ç»“æ„åŒ–æå–**: ä½¿ç”¨ LLM ä»æœç´¢ç»“æœä¸­æå–ç»“æ„åŒ–æ•°æ®ï¼ˆäº‹ä»¶æ‘˜è¦ã€æŒ‘æˆ˜ç±»å‹ã€åº”å¯¹ç­–ç•¥ã€æœ€ç»ˆç»“æœç­‰ï¼‰
- ğŸ·ï¸ **æ ‡ç­¾åŒ¹é…**: è‡ªåŠ¨ä¸ºç»å†åŒ¹é…10ç§ç±»å‹çš„æ ‡ç­¾ï¼Œä¾¿äºåˆ†ç±»æ£€ç´¢
- ğŸ“š **å‘é‡æ•°æ®åº“**: åŸºäº ElasticSearch æ„å»ºå‘é‡æ•°æ®åº“ï¼Œæ”¯æŒè¯­ä¹‰ç›¸ä¼¼åº¦æœç´¢
- ğŸ¯ **å¤šç§æ£€ç´¢æ–¹å¼**: æ”¯æŒå‘é‡æœç´¢ã€å…³é”®è¯æœç´¢å’Œæ ‡ç­¾è¿‡æ»¤

## é¡¹ç›®ç»“æ„

```
InspireMatch/
â”œâ”€â”€ data_construct/                  # æ•°æ®æ„å»ºç›¸å…³
â”‚   â”œâ”€â”€ celebrity_deeds/            # åäººåˆ—è¡¨ï¼ˆ9ä¸ªèŒä¸šï¼‰
â”‚   â”‚   â”œâ”€â”€ entrepreneurs.txt
â”‚   â”‚   â”œâ”€â”€ politicians.txt
â”‚   â”‚   â”œâ”€â”€ scientists.txt
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ flags/                      # ç»å†æ ‡ç­¾ï¼ˆ10ç§ç±»å‹ï¼‰
â”‚       â”œâ”€â”€ career_development_and_challenges.txt
â”‚       â”œâ”€â”€ enterpreneurship_and_innovation.txt
â”‚       â””â”€â”€ ...
â”‚
â”œâ”€â”€ vector_db_builder/              # å‘é‡æ•°æ®åº“æ„å»ºå·¥å…·
â”‚   â”œâ”€â”€ search_celebrity_experiences.py  # æœç´¢æ¨¡å—
â”‚   â”œâ”€â”€ extract_structured_data.py      # æ•°æ®æå–æ¨¡å—
â”‚   â”œâ”€â”€ tag_matching.py                 # æ ‡ç­¾åŒ¹é…æ¨¡å—
â”‚   â”œâ”€â”€ text_processing.py              # æ–‡æœ¬å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ elasticsearch_setup.py          # ESé…ç½®æ¨¡å—
â”‚   â”œâ”€â”€ build_vector_database.py        # ä¸»æµç¨‹è„šæœ¬
â”‚   â”œâ”€â”€ vector_search_example.py        # æœç´¢ç¤ºä¾‹
â”‚   â””â”€â”€ README.md                       # è¯¦ç»†æ–‡æ¡£
â”‚
â”œâ”€â”€ docker-compose.yml              # ElasticSearchéƒ¨ç½²é…ç½®
â”œâ”€â”€ requirements.txt                # Pythonä¾èµ–
â”œâ”€â”€ test_openrouter.py             # OpenRouter APIæµ‹è¯•
â””â”€â”€ README.md                       # æœ¬æ–‡ä»¶
```

## æ•°æ®æ ¼å¼

### åäººæ•°æ®æ ¼å¼
```
è‹±æ–‡å--ä¸­æ–‡å
ä¾‹å¦‚: Jack Ma--é©¬äº‘
```

### æ ‡ç­¾æ•°æ®æ ¼å¼
```
è‹±æ–‡æ ‡ç­¾--ä¸­æ–‡æ ‡ç­¾
ä¾‹å¦‚: Entrepreneurial Challenges--åˆ›ä¸šå›°éš¾
```

### ç»å†æ•°æ®æ ¼å¼ï¼ˆJSONï¼‰
```json
{
  "celebrity_name_en": "Jack Ma",
  "celebrity_name_cn": "é©¬äº‘",
  "profession": "entrepreneurs",
  "event_summary": "äº‹ä»¶æ‘˜è¦",
  "challenge_type": "æŒ‘æˆ˜ç±»å‹",
  "coping_strategy": "åº”å¯¹ç­–ç•¥",
  "final_result": "æœ€ç»ˆç»“æœ",
  "tags": ["æ ‡ç­¾1", "æ ‡ç­¾2"],
  "embedding": [0.123, 0.456, ...],
  "chunk_id": "Jack Ma_0",
  "full_text": "å®Œæ•´æ–‡æœ¬å†…å®¹"
}
```

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶æˆ–è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
export OPENROUTER_API_KEY=your_openrouter_api_key_here
export ELASTICSEARCH_HOST=localhost
export ELASTICSEARCH_PORT=9200
export ELASTICSEARCH_INDEX=celebrity_experiences
```

### 3. å¯åŠ¨ ElasticSearch

```bash
docker-compose up -d
```

ç­‰å¾… ElasticSearch å¯åŠ¨å®Œæˆï¼ˆçº¦30ç§’ï¼‰ï¼ŒéªŒè¯ï¼š

```bash
curl http://localhost:9200
```

**æ³¨æ„**: ElasticSearch æ•°æ®å°†å­˜å‚¨åœ¨ `/home/linweiquan/elasticresearch/data` ç›®å½•ä¸­ã€‚

### åœæ­¢ ElasticSearch æœåŠ¡

```bash
# åœæ­¢æœåŠ¡ï¼ˆä¿æŒå®¹å™¨å’Œæ•°æ®ï¼‰
docker-compose stop

# åœæ­¢å¹¶åˆ é™¤å®¹å™¨ï¼ˆæ•°æ®ä¼šä¿ç•™åœ¨å·ä¸­ï¼‰
docker-compose down

```

**è¯´æ˜**ï¼š
- `docker-compose stop`: åœæ­¢å®¹å™¨ä½†ä¿ç•™å®¹å™¨å’Œæ•°æ®ï¼Œé€‚åˆä¸´æ—¶åœæ­¢æœåŠ¡
- `docker-compose down`: åœæ­¢å¹¶åˆ é™¤å®¹å™¨ï¼Œä½†ä¿ç•™æ•°æ®å·ï¼Œé€‚åˆéœ€è¦æ¸…ç†å®¹å™¨æ—¶ä½¿ç”¨

### æ£€æŸ¥ Docker å®¹å™¨çŠ¶æ€

```bash
# ä½¿ç”¨ docker-compose æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼ˆæ¨èï¼‰
docker-compose ps

# æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨
docker ps

# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬åœæ­¢çš„ï¼‰
docker ps -a

# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs inspirematch_elasticsearch

# å®æ—¶æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs -f inspirematch_elasticsearch

# æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯
docker inspect inspirematch_elasticsearch
```

**è¯´æ˜**ï¼š
- `docker-compose ps`: ä½¿ç”¨ docker-compose æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼Œæ˜¾ç¤ºå®¹å™¨åç§°ã€çŠ¶æ€ã€ç«¯å£ç­‰ä¿¡æ¯
- `docker ps`: åªæ˜¾ç¤ºè¿è¡Œä¸­çš„å®¹å™¨
- `docker ps -a`: æ˜¾ç¤ºæ‰€æœ‰å®¹å™¨ï¼ŒåŒ…æ‹¬å·²åœæ­¢çš„
- `docker logs`: æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼Œç”¨äºæ’æŸ¥é—®é¢˜
- `docker inspect`: æŸ¥çœ‹å®¹å™¨çš„è¯¦ç»†é…ç½®ä¿¡æ¯

### 4. æ„å»ºå‘é‡æ•°æ®åº“

```bash
cd vector_db_builder
python build_vector_database.py
```

è¿™ä¸ªè¿‡ç¨‹åŒ…æ‹¬ï¼š
1. æœç´¢æ‰€æœ‰åäººçš„ç»å†ï¼ˆä½¿ç”¨ sonar-pro-searchï¼‰
2. æå–ç»“æ„åŒ–æ•°æ®ï¼ˆä½¿ç”¨ LLMï¼‰
3. åŒ¹é…æ ‡ç­¾
4. æ–‡æœ¬åˆ‡å—å’Œå‘é‡åµŒå…¥
5. å­˜å‚¨åˆ° ElasticSearch

**æ³¨æ„**: æ•´ä¸ªè¿‡ç¨‹å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œå»ºè®®åœ¨åå°è¿è¡Œæˆ–ä½¿ç”¨æ–­ç‚¹ç»­ä¼ ã€‚

### 5. æœç´¢ç¤ºä¾‹

```bash
# å‘é‡æœç´¢
python vector_search_example.py "å¦‚ä½•åº”å¯¹åˆ›ä¸šå›°éš¾" --size 5

# å¸¦æ ‡ç­¾è¿‡æ»¤
python vector_search_example.py "å¦‚ä½•åº”å¯¹åˆ›ä¸šå›°éš¾" --tags "Entrepreneurial Challenges" --size 5

# å…³é”®è¯æœç´¢
python vector_search_example.py "åˆ›ä¸š" --keyword --size 5
```

## è¯¦ç»†æ–‡æ¡£

æ›´è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜è¯·å‚è€ƒï¼š
- [å‘é‡æ•°æ®åº“æ„å»ºå·¥å…·æ–‡æ¡£](./vector_db_builder/README.md)
- [å¿«é€Ÿå¯åŠ¨æŒ‡å—](./vector_db_builder/QUICKSTART.md)
- [å®ç°æ€»ç»“](./vector_db_builder/IMPLEMENTATION_SUMMARY.md)

## æŠ€æœ¯æ ˆ

- **æœç´¢**: sonar-pro-search (via OpenRouter)
- **æ•°æ®æå–**: GPT-4o-mini (via OpenRouter)
- **å‘é‡åµŒå…¥**: text-embedding-3-small (1536ç»´)
- **å‘é‡æ•°æ®åº“**: ElasticSearch 8.x
- **æ–‡æœ¬å¤„ç†**: tiktoken

## æ•°æ®æ¥æº

- **9ä¸ªèŒä¸šé¢†åŸŸ**: æ”¿æ²»å®¶ã€ç§‘å­¦å®¶ã€ä¼ä¸šå®¶ã€è‰ºæœ¯å®¶ã€è¿åŠ¨å‘˜ã€æ¼”å‘˜ä¸å¨±ä¹åœˆäººç‰©ã€ä½œå®¶ä¸å“²å­¦å®¶ã€ç¤¾ä¼šæ´»åŠ¨å®¶ã€æ•™è‚²å·¥ä½œè€…
- **10ç§ç»å†æ ‡ç­¾ç±»å‹**: 
  - èŒä¸šå‘å±•ä¸äº‹ä¸šæŒ‘æˆ˜
  - å¿ƒç†å¥åº·ä¸æƒ…æ„Ÿå›°å¢ƒ
  - ä¸ªäººæˆé•¿ä¸è‡ªæˆ‘æå‡
  - å…³ç³»ä¸äººé™…äº¤å¾€
  - è´¢åŠ¡ä¸ç”Ÿæ´»å›°å¢ƒ
  - èº«ä½“å¥åº·ä¸è¿åŠ¨
  - åˆ›ä¸šä¸åˆ›æ–°
  - æ•™è‚²ä¸å­¦ä¹ 
  - ç¤¾ä¼šè´£ä»»ä¸å½±å“åŠ›
  - å¤±è´¥ä¸æ¢å¤

## ä½¿ç”¨åœºæ™¯

- ğŸ“– **ä¸ªäººæˆé•¿**: ä»åäººç»å†ä¸­å­¦ä¹ åº”å¯¹æŒ‘æˆ˜çš„ç­–ç•¥
- ğŸ’¼ **èŒä¸šå‘å±•**: äº†è§£ä¸åŒèŒä¸šé¢†åŸŸçš„æˆåŠŸç»éªŒ
- ğŸ¯ **é—®é¢˜è§£å†³**: é€šè¿‡ç›¸ä¼¼ç»å†æ‰¾åˆ°è§£å†³é—®é¢˜çš„æ–¹æ³•
- ğŸ“š **çŸ¥è¯†æ£€ç´¢**: å¿«é€Ÿæ£€ç´¢å’ŒåŒ¹é…ç›¸å…³ç»å†æ¡ˆä¾‹

## æ–­ç‚¹ç»­ä¼ 

å¦‚æœæ„å»ºè¿‡ç¨‹ä¸­æ–­ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‚æ•°è·³è¿‡å·²å®Œæˆçš„æ­¥éª¤ï¼š

```bash
# è·³è¿‡æœç´¢æ­¥éª¤ï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰
python build_vector_database.py --skip-search

# è·³è¿‡æœç´¢å’Œæå–æ­¥éª¤
python build_vector_database.py --skip-search --skip-extract

# è·³è¿‡æœç´¢ã€æå–å’Œæ ‡ç­¾åŒ¹é…
python build_vector_database.py --skip-search --skip-extract --skip-tags
```

ç¼“å­˜æ–‡ä»¶ä¿å­˜åœ¨ `vector_db_builder/cache/` ç›®å½•ä¸­ã€‚

## åœ¨ä»£ç ä¸­ä½¿ç”¨

```python
from vector_db_builder.vector_search_example import search_experiences

# å‘é‡æœç´¢
results = search_experiences("å¦‚ä½•åº”å¯¹èŒä¸šæŒ‘æˆ˜", size=10)

# å¸¦æ ‡ç­¾è¿‡æ»¤
results = search_experiences(
    "å¦‚ä½•åº”å¯¹åˆ›ä¸šå›°éš¾",
    size=10,
    filter_tags=["Entrepreneurial Challenges", "Lack of Startup Funds"]
)
```

## æ•…éšœæ’é™¤

### ElasticSearch è¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker ps

# æŸ¥çœ‹æ—¥å¿—
docker logs inspirematch_elasticsearch

# é‡å¯å®¹å™¨
docker-compose restart
```

### API è°ƒç”¨å¤±è´¥

æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®è®¾ç½®ï¼š
```bash
echo $OPENROUTER_API_KEY
```

### ç´¢å¼•é—®é¢˜

åˆ é™¤å¹¶é‡å»ºç´¢å¼•ï¼š
```python
from vector_db_builder.elasticsearch_setup import ElasticsearchSetup
es = ElasticsearchSetup()
es.es.indices.delete(index="celebrity_experiences", ignore=[404])
es.create_index("celebrity_experiences")
```

## æ›´æ–°æ•°æ®

### æ›´æ–°äººå

äººåæ•°æ®å­˜å‚¨åœ¨ `data_construct/celebrity_deeds/` ç›®å½•ä¸‹ï¼ŒæŒ‰èŒä¸šåˆ†ç±»ï¼š

```
data_construct/celebrity_deeds/
â”œâ”€â”€ entrepreneurs.txt          # ä¼ä¸šå®¶
â”œâ”€â”€ politicians.txt            # æ”¿æ²»å®¶
â”œâ”€â”€ scientists.txt             # ç§‘å­¦å®¶
â”œâ”€â”€ artists.txt                # è‰ºæœ¯å®¶
â”œâ”€â”€ athletes.txt               # è¿åŠ¨å‘˜
â”œâ”€â”€ actors_entertainers.txt    # æ¼”å‘˜ä¸å¨±ä¹åœˆäººç‰©
â”œâ”€â”€ writers_philosophers.txt   # ä½œå®¶ä¸å“²å­¦å®¶
â”œâ”€â”€ activists.txt              # ç¤¾ä¼šæ´»åŠ¨å®¶
â””â”€â”€ educators.txt              # æ•™è‚²å·¥ä½œè€…
```

**æ ¼å¼è¦æ±‚**ï¼š
- æ¯è¡Œä¸€ä¸ªåäººï¼Œæ ¼å¼ï¼š`è‹±æ–‡å--ä¸­æ–‡å`
- ä¾‹å¦‚ï¼š`Jack Ma--é©¬äº‘`
- æ³¨æ„ä½¿ç”¨ `--`ï¼ˆä¸¤ä¸ªçŸ­æ¨ªçº¿ï¼‰åˆ†éš”è‹±æ–‡åå’Œä¸­æ–‡å

**æ›´æ–°æ­¥éª¤**ï¼š
1. ç¼–è¾‘å¯¹åº”èŒä¸šçš„ `.txt` æ–‡ä»¶ï¼Œæ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤äººå
2. ä¿å­˜æ–‡ä»¶
3. é‡æ–°æ„å»ºæ•°æ®åº“ï¼ˆè§ä¸‹æ–‡ï¼‰

### æ›´æ–°æ ‡ç­¾

æ ‡ç­¾æ•°æ®å­˜å‚¨åœ¨ `data_construct/flags/` ç›®å½•ä¸‹ï¼ŒæŒ‰æ ‡ç­¾ç±»å‹åˆ†ç±»ï¼š

```
data_construct/flags/
â”œâ”€â”€ career_development_and_challenges.txt          # èŒä¸šå‘å±•ä¸äº‹ä¸šæŒ‘æˆ˜
â”œâ”€â”€ mental_health_emotional_challenges.txt         # å¿ƒç†å¥åº·ä¸æƒ…æ„Ÿå›°å¢ƒ
â”œâ”€â”€ personal_growth_and_self-improvement.txt       # ä¸ªäººæˆé•¿ä¸è‡ªæˆ‘æå‡
â”œâ”€â”€ relationships_interpersonal_communication.txt  # å…³ç³»ä¸äººé™…äº¤å¾€
â”œâ”€â”€ financial_life_challenges.txt                  # è´¢åŠ¡ä¸ç”Ÿæ´»å›°å¢ƒ
â”œâ”€â”€ physical_health_fitness.txt                    # èº«ä½“å¥åº·ä¸è¿åŠ¨
â”œâ”€â”€ enterpreneurship_and_innovation.txt            # åˆ›ä¸šä¸åˆ›æ–°
â”œâ”€â”€ education_and_learning.txt                     # æ•™è‚²ä¸å­¦ä¹ 
â”œâ”€â”€ social_responsibility_and_impact.txt           # ç¤¾ä¼šè´£ä»»ä¸å½±å“åŠ›
â””â”€â”€ resilience_and_comebacks.txt                   # å¤±è´¥ä¸æ¢å¤
```

**æ ¼å¼è¦æ±‚**ï¼š
- æ¯è¡Œä¸€ä¸ªæ ‡ç­¾ï¼Œæ ¼å¼ï¼š`è‹±æ–‡æ ‡ç­¾--ä¸­æ–‡æ ‡ç­¾`
- ä¾‹å¦‚ï¼š`Entrepreneurial Mindset--åˆ›ä¸šå¿ƒæ€`
- æ³¨æ„ä½¿ç”¨ `--`ï¼ˆä¸¤ä¸ªçŸ­æ¨ªçº¿ï¼‰åˆ†éš”è‹±æ–‡å’Œä¸­æ–‡æ ‡ç­¾

**æ›´æ–°æ­¥éª¤**ï¼š
1. ç¼–è¾‘å¯¹åº”æ ‡ç­¾ç±»å‹çš„ `.txt` æ–‡ä»¶ï¼Œæ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤æ ‡ç­¾
2. ä¿å­˜æ–‡ä»¶
3. é‡æ–°æ„å»ºæ•°æ®åº“ï¼ˆè§ä¸‹æ–‡ï¼‰

### é‡æ–°æ„å»ºæ•°æ®åº“

æ›´æ–°äººåæˆ–æ ‡ç­¾åï¼Œéœ€è¦é‡æ–°æ„å»ºå‘é‡æ•°æ®åº“ã€‚**é‡è¦**ï¼šç”±äºæ„å»ºæµç¨‹çš„ä¾èµ–å…³ç³»ï¼Œä¸åŒçš„æ›´æ–°åœºæ™¯éœ€è¦æ‰§è¡Œä¸åŒçš„æ­¥éª¤ã€‚

#### åœºæ™¯ 1ï¼šæ·»åŠ æ–°äººå

**æµç¨‹è¯´æ˜**ï¼š
- æœç´¢ä¼šé‡æ–°è¯»å–æ‰€æœ‰åäººåˆ—è¡¨ï¼ˆåŒ…æ‹¬æ–°å¢çš„ï¼‰ï¼Œæ‰€ä»¥å¿…é¡»é‡æ–°æœç´¢
- æ–°å¢åäººçš„æœç´¢ç»“æœéœ€è¦æå–ç»“æ„åŒ–ä¿¡æ¯
- æå–çš„ç»å†éœ€è¦åŒ¹é…æ ‡ç­¾
- æœ€ç»ˆéœ€è¦ç”Ÿæˆå‘é‡å¹¶ç´¢å¼•

**æ¨èæ–¹æ³•ï¼šå®Œå…¨é‡å»º**

```bash
cd vector_db_builder

# 1. åˆ é™¤æ—§ç´¢å¼•ï¼ˆä¼šåˆ é™¤æ‰€æœ‰å·²ç´¢å¼•çš„æ•°æ®ï¼‰
python -c "
from elasticsearch_setup import ElasticsearchSetup
es = ElasticsearchSetup()
es.es.indices.delete(index='celebrity_experiences', ignore=[404])
print('ç´¢å¼•å·²åˆ é™¤')
"

# 2. åˆ é™¤ç¼“å­˜ï¼ˆç¡®ä¿ä½¿ç”¨æœ€æ–°çš„æ•°æ®ï¼‰
rm -rf cache/*.json

# 3. å®Œå…¨é‡æ–°æ„å»ºï¼ˆä¼šæœç´¢æ‰€æœ‰åäººï¼ŒåŒ…æ‹¬æ–°å¢çš„ï¼‰
python build_vector_database.py
```

**åŸå› **ï¼šä¸èƒ½ä½¿ç”¨ä»»ä½•è·³è¿‡å‚æ•°ï¼Œå› ä¸ºï¼š
- ä¸èƒ½è·³è¿‡æœç´¢ï¼šæ–°åäººçš„æœç´¢ç»“æœä¸å­˜åœ¨äºç¼“å­˜ä¸­
- ä¸èƒ½è·³è¿‡æå–ï¼šæ–°åäººçš„æœç´¢ç»“æœéœ€è¦æå–ç»“æ„åŒ–ä¿¡æ¯
- ä¸èƒ½è·³è¿‡æ ‡ç­¾åŒ¹é…ï¼šæ–°ç»å†éœ€è¦åŒ¹é…æ ‡ç­¾
- ä¸èƒ½è·³è¿‡å‘é‡åŒ–ï¼šæ–°æ•°æ®éœ€è¦ç”Ÿæˆå‘é‡

#### åœºæ™¯ 2ï¼šä¿®æ”¹/åˆ é™¤äººå

**æµç¨‹è¯´æ˜**ï¼š
- éœ€è¦åˆ é™¤æ—§æ•°æ®ï¼Œé‡æ–°æœç´¢æ‰€æœ‰åäºº
- å¿…é¡»å®Œå…¨é‡å»ºä»¥ç¡®ä¿æ•°æ®ä¸€è‡´æ€§

**æ¨èæ–¹æ³•ï¼šå®Œå…¨é‡å»º**

```bash
cd vector_db_builder

# 1. åˆ é™¤æ—§ç´¢å¼•
python -c "
from elasticsearch_setup import ElasticsearchSetup
es = ElasticsearchSetup()
es.es.indices.delete(index='celebrity_experiences', ignore=[404])
print('ç´¢å¼•å·²åˆ é™¤')
"

# 2. åˆ é™¤ç¼“å­˜
rm -rf cache/*.json

# 3. å®Œå…¨é‡æ–°æ„å»º
python build_vector_database.py
```

#### åœºæ™¯ 3ï¼šæ·»åŠ /ä¿®æ”¹æ ‡ç­¾

**æµç¨‹è¯´æ˜**ï¼š
- ç»å†æ•°æ®æ²¡æœ‰å˜åŒ–ï¼Œå¯ä»¥è·³è¿‡æœç´¢å’Œæå–
- éœ€è¦é‡æ–°åŒ¹é…æ ‡ç­¾ï¼ˆä½¿ç”¨æ–°çš„æ ‡ç­¾åˆ—è¡¨ï¼‰
- æ ‡ç­¾å˜åŒ–åéœ€è¦é‡æ–°ç”Ÿæˆå‘é‡ï¼ˆå› ä¸ºæ ‡ç­¾æ˜¯ç´¢å¼•çš„ä¸€éƒ¨åˆ†ï¼‰
- æœ€åé‡æ–°ç´¢å¼•

**æ¨èæ–¹æ³•ï¼šä½¿ç”¨ç¼“å­˜è·³è¿‡æœç´¢å’Œæå–**

```bash
cd vector_db_builder

# 1. åˆ é™¤æ—§ç´¢å¼•
python -c "
from elasticsearch_setup import ElasticsearchSetup
es = ElasticsearchSetup()
es.es.indices.delete(index='celebrity_experiences', ignore=[404])
print('ç´¢å¼•å·²åˆ é™¤')
"

# 2. ä»ç¼“å­˜åŠ è½½å·²æœ‰çš„ç»å†æ•°æ®ï¼Œé‡æ–°åŒ¹é…æ ‡ç­¾ï¼ˆä½¿ç”¨æ–°çš„æ ‡ç­¾åˆ—è¡¨ï¼‰ï¼Œç„¶åé‡æ–°å‘é‡åŒ–å’Œç´¢å¼•
python build_vector_database.py --skip-search --skip-extract
```

**è¯´æ˜**ï¼š
- `--skip-search`ï¼šè·³è¿‡æœç´¢æ­¥éª¤ï¼Œä½¿ç”¨ç¼“å­˜ä¸­çš„æœç´¢ç»“æœ
- `--skip-extract`ï¼šè·³è¿‡æå–æ­¥éª¤ï¼Œä½¿ç”¨ç¼“å­˜ä¸­çš„ç»“æ„åŒ–ç»å†æ•°æ®
- ä¼šé‡æ–°æ‰§è¡Œæ ‡ç­¾åŒ¹é…ï¼ˆä½¿ç”¨æ–°çš„æ ‡ç­¾åˆ—è¡¨ï¼‰ã€å‘é‡åŒ–å’Œç´¢å¼•

#### åœºæ™¯ 4ï¼šåˆ é™¤æ ‡ç­¾

**æµç¨‹è¯´æ˜**ï¼š
- åˆ é™¤æ ‡ç­¾å¯èƒ½å½±å“å·²æœ‰ç»å†çš„æ ‡ç­¾åŒ¹é…ç»“æœ
- ä¸ºç¡®ä¿æ•°æ®ä¸€è‡´æ€§ï¼Œå»ºè®®å®Œå…¨é‡å»º

**æ¨èæ–¹æ³•ï¼šå®Œå…¨é‡å»º**

```bash
cd vector_db_builder

# 1. åˆ é™¤æ—§ç´¢å¼•
python -c "
from elasticsearch_setup import ElasticsearchSetup
es = ElasticsearchSetup()
es.es.indices.delete(index='celebrity_experiences', ignore=[404])
print('ç´¢å¼•å·²åˆ é™¤')
"

# 2. åˆ é™¤ç¼“å­˜
rm -rf cache/*.json

# 3. å®Œå…¨é‡æ–°æ„å»º
python build_vector_database.py
```

### æ›´æ–°æµç¨‹æ€»ç»“

| æ›´æ–°å†…å®¹ | éœ€è¦é‡æ–°æ‰§è¡Œçš„æ­¥éª¤ | èƒ½å¦ä½¿ç”¨ç¼“å­˜ | æ¨èå‘½ä»¤ |
|---------|------------------|------------|---------|
| æ·»åŠ æ–°äººå | æœç´¢ â†’ æå– â†’ æ ‡ç­¾åŒ¹é… â†’ å‘é‡åŒ– â†’ ç´¢å¼• | âŒ ä¸èƒ½ï¼ˆæ–°æ•°æ®ä¸åœ¨ç¼“å­˜ä¸­ï¼‰ | åˆ é™¤ç´¢å¼•å’Œç¼“å­˜åè¿è¡Œ `python build_vector_database.py` |
| ä¿®æ”¹/åˆ é™¤äººå | æœç´¢ â†’ æå– â†’ æ ‡ç­¾åŒ¹é… â†’ å‘é‡åŒ– â†’ ç´¢å¼• | âŒ ä¸èƒ½ï¼ˆéœ€è¦åˆ é™¤æ—§æ•°æ®ï¼‰ | åˆ é™¤ç´¢å¼•å’Œç¼“å­˜åè¿è¡Œ `python build_vector_database.py` |
| æ·»åŠ /ä¿®æ”¹æ ‡ç­¾ | æ ‡ç­¾åŒ¹é… â†’ å‘é‡åŒ– â†’ ç´¢å¼• | âœ… å¯ä»¥ï¼ˆç»å†æ•°æ®æœªå˜ï¼‰ | åˆ é™¤ç´¢å¼•åè¿è¡Œ `python build_vector_database.py --skip-search --skip-extract` |
| åˆ é™¤æ ‡ç­¾ | æœç´¢ â†’ æå– â†’ æ ‡ç­¾åŒ¹é… â†’ å‘é‡åŒ– â†’ ç´¢å¼• | âŒ å»ºè®®ä¸ï¼ˆç¡®ä¿ä¸€è‡´æ€§ï¼‰ | åˆ é™¤ç´¢å¼•å’Œç¼“å­˜åè¿è¡Œ `python build_vector_database.py` |

### æ„å»ºæ­¥éª¤è¯´æ˜

å®Œæ•´çš„æ„å»ºæµç¨‹åŒ…å«5ä¸ªæ­¥éª¤ï¼š

1. **æœç´¢åäººç»å†** (`--skip-search`): ä»æ–‡ä»¶è¯»å–æ‰€æœ‰åäººï¼Œè°ƒç”¨APIæœç´¢ç»å†
2. **æå–ç»“æ„åŒ–æ•°æ®** (`--skip-extract`): ä»æœç´¢ç»“æœä¸­æå–ç»“æ„åŒ–ç»å†ï¼ˆäº‹ä»¶æ‘˜è¦ã€æŒ‘æˆ˜ç±»å‹ã€åº”å¯¹ç­–ç•¥ã€æœ€ç»ˆç»“æœï¼‰
3. **æ ‡ç­¾åŒ¹é…** (`--skip-tags`): ä¸ºæ¯æ¡ç»å†åŒ¹é…æ ‡ç­¾ï¼ˆä»æ ‡ç­¾åˆ—è¡¨ä¸­é€‰æ‹©ï¼‰
4. **æ–‡æœ¬å¤„ç†å’Œå‘é‡åµŒå…¥** (`--skip-processing`): å°†ç»å†åˆ‡å—å¹¶ç”Ÿæˆå‘é‡åµŒå…¥
5. **å­˜å‚¨åˆ°ElasticSearch**: å°†å‘é‡åŒ–çš„æ•°æ®ç´¢å¼•åˆ°ES

**é‡è¦æç¤º**ï¼š
- å¦‚æœè·³è¿‡äº†æŸä¸ªæ­¥éª¤ï¼Œè¯¥æ­¥éª¤ä¼šä»ç¼“å­˜ä¸­åŠ è½½æ•°æ®
- å¦‚æœç¼“å­˜ä¸­ä¸å­˜åœ¨éœ€è¦çš„æ•°æ®ï¼Œæ„å»ºä¼šå¤±è´¥
- æ–°å¢äººåæ—¶ï¼Œæ–°åäººçš„æ•°æ®ä¸å­˜åœ¨äºä»»ä½•ç¼“å­˜ä¸­ï¼Œå› æ­¤ä¸èƒ½è·³è¿‡ä»»ä½•æ­¥éª¤

### éªŒè¯æ›´æ–°

æ›´æ–°å®Œæˆåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼éªŒè¯ï¼š

```bash
# 1. æ£€æŸ¥ç´¢å¼•ä¸­çš„æ–‡æ¡£æ•°é‡
curl "http://localhost:9200/celebrity_experiences/_count?pretty"

# 2. æœç´¢æµ‹è¯•
cd vector_db_builder
python vector_search_example.py "æµ‹è¯•æŸ¥è¯¢" --size 5

# 3. æ£€æŸ¥ç‰¹å®šåäººçš„æ•°æ®
curl "http://localhost:9200/celebrity_experiences/_search?q=celebrity_name_cn:é©¬äº‘&pretty"
```

## æ³¨æ„äº‹é¡¹

1. **API é™æµ**: æœç´¢å’Œæå–è¿‡ç¨‹ä¼šè°ƒç”¨ OpenRouter APIï¼Œè¯·æ³¨æ„ API é™æµã€‚ä»£ç ä¸­å·²æ·»åŠ å»¶è¿Ÿä»¥é¿å…è¿‡å¿«è¯·æ±‚ã€‚
2. **ElasticSearch å†…å­˜**: é»˜è®¤é…ç½®ä½¿ç”¨ 512MB å†…å­˜ï¼Œå¦‚æœæ•°æ®é‡å¤§å¯èƒ½éœ€è¦è°ƒæ•´ `docker-compose.yml` ä¸­çš„å†…å­˜è®¾ç½®ã€‚
3. **æ•°æ®æŒä¹…åŒ–**: ElasticSearch æ•°æ®å­˜å‚¨åœ¨ `/home/linweiquan/elasticresearch/data`ï¼Œåˆ é™¤å®¹å™¨å‰è¯·ç¡®ä¿æ•°æ®å·²å¤‡ä»½ã€‚
4. **å‘é‡ç»´åº¦**: ä½¿ç”¨ `text-embedding-3-small` æ¨¡å‹ï¼Œå‘é‡ç»´åº¦ä¸º 1536ã€‚
5. **æ•°æ®æ ¼å¼**: äººåå’Œæ ‡ç­¾æ–‡ä»¶å¿…é¡»ä½¿ç”¨ `--`ï¼ˆä¸¤ä¸ªçŸ­æ¨ªçº¿ï¼‰åˆ†éš”è‹±æ–‡å’Œä¸­æ–‡ï¼Œæ ¼å¼é”™è¯¯ä¼šå¯¼è‡´è§£æå¤±è´¥ã€‚
6. **ç¼“å­˜ç®¡ç†**: æ›´æ–°æ•°æ®åå»ºè®®æ¸…ç†ç¼“å­˜ï¼Œç¡®ä¿ä½¿ç”¨æœ€æ–°çš„æ•°æ®ã€‚
7. **ç´¢å¼•é‡å»º**: æ›´æ–°äººåæˆ–å¤§é‡æ ‡ç­¾åï¼Œå»ºè®®åˆ é™¤æ—§ç´¢å¼•å¹¶å®Œå…¨é‡å»ºï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚

## è®¸å¯è¯

[æ·»åŠ è®¸å¯è¯ä¿¡æ¯]

## è´¡çŒ®
https://github.com/Eric-Lin-HKUSTGZ


## è”ç³»æ–¹å¼

s-lwq25@bjzgca.edu.cn
